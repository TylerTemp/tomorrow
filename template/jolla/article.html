{% extends "base.html" %}

{% block main_title %}
  {{ article['title'] }} | {{ _('Jolla Blog') }} |
{% end %}

{% block neck %}
<link rel="stylesheet" href="{{ static_path('css/duoshuo.css') }}">
<link rel="stylesheet" href="{{ static_path('css/jolla/article.css') }}">
{% end %}

{% block nav %}{% end %}

{% block stomach %}
<div class="am-g-fixed am-g-fixed am-g-collapse am-u-sm-centered">
  <div class="am-u-sm-12 am-margin-left" style="color: #fff">
    <a class="am-text-sm am-btn-link" style="color: #fff" href="//{{ MAIN_HOST }}/">&laquo; tomorrow</a>
  </div>
</div>

<header>
  <div class="am-margin-lg am-text-center">
    <a href="//{{ JOLLA_HOST }}/"><img src="https://dn-jolla.qbox.me/blog_header.png" alt="{{ _("Jolla Unofficial Chinese Blog") }}"></a>
  </div>
</header>

<div class="am-u-sm-centered am-g-fixed">
  {% if await %}
  <div class="am-alert" data-am-alert>
    <button type="button" class="am-close">&times;</button>
    <p>{{ _("Thanks for translation, we are checking if it's appropriate") }}</p>
  </div>
  {% end %}
  {% if reject %}
  <div class="am-alert am-alert-warning" data-am-alert>
    <button type="button" class="am-close">&times;</button>
    <p>{{ _("This article is not taken as the final translate. Sorry.") }}</p>
  </div>
  {% end %}

  <div class="am-g" id="bread-crumbs">
    <div class="am-u-sm-6" style="text-align: left">
      <span class="am-icon-arrow-circle-left"> <a class="am-text-sm" href="/">{{ _('Back to home') }}<a/></span> &nbsp;
    </div>
    <div class="am-u-sm-6 am-cf">

      <div class="am-dropdown am-fr" data-am-dropdown  data-role="switch-lang-dropper">
        <button class="am-btn am-btn-link am-dropdown-toggle am-btn-sm" style="color: #fff"><span class="am-icon-globe"></span> <span class="am-icon-caret-down"></span></button>
        <ul class="am-dropdown-content">
          <li class="am-dropdown-header">修改语言/Change Language</li>
          <li class="{{ 'am-active' if locale.code[:2] == 'zh' else '' }}">
            <a href="./?lang=zh" data-role="switch-lang" data-lang="zh" style="color: #000"><span class="am-badge am-badge-success">zh-CN</span> 中文/Chinese</a>
          </li>
          <li class="{{ 'am-active' if locale.code[:2] == 'en' else '' }}">
            <a href="./?lang=en" data-role="switch-lang" data-lang="en" style="color: #000"><span class="am-badge am-badge-success">en-US</span> 英文/English</a>
          </li>
        </ul>
      </div>

    </div>
  </div>


  {% if img %}
    <img src="{{ img }}" id="title-img">
  {% end %}
  <div class="am-g am-margin-bottom-xl" id="white-bg-box">
    <div class="am-u-sm-12 am-u-sm-centered" id="page-box">
      <article class="am-article">
        <div class="am-article-hd">
          <h1 class="am-article-title">{{ article['title'] }}</h1>
          <p class="am-article-meta">
            {% raw make_source(article['source']) %}
            {% raw ('| ' + ' '.join(make_tag(article['tag']))) if article['tag'] else '' %}
            <br />
            {% raw _('Posted by {email}{name} on {time}').format(
              email=('<a href="mailto:%s" target="_blank"><span class="am-icon-envelope"></span></a>' % author['email']) if author['email'] else '',
              name='<a href="//%s/hi/%s/">%s</a>' % (MAIN_HOST, quote(author['name']), author['name']),
              time='<time>%s</time>' % createtime) %}
          </p>
        </div>

        <hr class="am-article-divider">
        <div class="am-article-bd">
          {% if article['description'] %}
            <div class="am-article-lead">{% raw article['description'] %}</div>
          {% end %}
          {% raw article['content'] %}
          <!-- Jolla blog author translation -->
          {% if original %}
            <hr class="am-article-divider">
            <div class="am-g am-u-sm-centered" id="original-author">
            {% if original['author']['photo'] %}
            <div class="am-u-sm-12 am-u-md-4">
              <img class="am-circle am-thumbnail am-center" src="{{ original['author']['photo'] }}">
            </div>
            <div class="am-u-sm-12 am-u-md-8">
              <h6>{{ original['author']['name'] }}</h6>
              {% raw original['author']['intro'] or '' %}
            </div>
            {% elif original['author']['intro'] %}
            <div class="am-u-sm-12">
              <h6>{{ original['author']['name'] }}</h6>
              {% raw original['author']['intro'] %}
            </div>
            {% end %}
          </div>
          {% end %}

        </div>

        {% if original %}
        <footer>
          <p>原文由 {{ original['author']['name'] }} 发布于
            <a href="{{ original['link'] }}">{{ original['title'] }}</a>
          </p>
        </footer>
        {% end %}
        <!-- Translator -->
        <hr class="am-article-divider">
        {% if original %}
          <p>{{ _('Translated by') }}</p>
        {% end %}
      </article>
      <div class="am-padding-top">


        <div class="am-g am-u-sm-centered">
          {% if author['photo'] %}
          <div class="am-u-sm-3">
            <a href="//{{ MAIN_HOST }}/hi/{{ author['name'] }}/">
              <img class="am-circle am-thumbnail am-center" src="{{ author['photo'] }}">
            </a>
          </div>
          <div class="am-u-sm-9">
          {% else %}
          <div class="am-u-sm-12">
          {% end %}
            <div class="am-margin-horizontal">
              <a href="//{{ MAIN_HOST }}/hi/{{ author['name'] }}/"><h6>{{ author['name'] }}</h6></a>
              {% raw author['intro'] or '' %}
              {% raw author['donate'] or '' %}
            </div>
          </div>
        </div>


      </div>
      <hr class="am-divider am-divider-dotted" />
      <div data-am-widget="duoshuo" class="am-duoshuo am-duoshuo-default" data-ds-short-name="tmr" id="comment">
        <div class="ds-thread"
             data-thread-key="{{ article['id'] }}"
             data-title="{{ article['title'] }}"
             {% if img %}data-image="{{ img }}"{% end %}
             data-form-position="top"></div>
      </div>

    </div>
  </div>
</div>

{% end %}
{% block leg %}
<script type="text/javascript">
var duoshuoQuery = {short_name:"tmr"};
  $(function(){
  (function()
  {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]
    ).appendChild(ds);
  })();
});
</script>
{% end %}