{% extends "base.html" %}

{% block title %}
  {{ article['translated']['title'] }} | {{ _('Jolla Blog') }}
{% end %}

{% block neck %}
<style>
  body {
    background-image: url("https://dn-jolla.qbox.me/blog_bg_top.jpg"),
                      url("https://dn-jolla.qbox.me/blog_bg_base.jpg");
    background-repeat: no-repeat, repeat;
    background-size: 100% auto, auto auto;
    background-position: right top;
    background-color: #5BA2A1;
  }

  header img {
    width: 100%;
    height: auto;
    max-width: 400px;
  }

  #title-img {
    width: 100%;
    height: auto;
  }

  #white-bg-box {
    background-color: #FFF;
  }

  article h1 {
    text-align: center;
  }

  article p img {
    max-width: 100%;
    height: auto;
    /*margin: 0em 0em 0em -2em;*/
  }

  #page-box {
    padding-top: 50px;
    max-width: 600px;

  }

  .am-article-bd p {
    text-indent: 2em;
  }

  .footnote p,
  #original-author p {
    text-indent: 0em;
  }

  #bread-crumbs {
    color: #fff;
  }

  #bread-crumbs a:link {
    color: #fff;
  }
  #bread-crumbs a:visited {
    color: #fff;
  }
  #bread-crumbs a:hover {
    color: #fff;
    text-decoration:underline;
  }

  .am-footer-default {
    background-color: transparent;
    color: #fff;
  }
  .am-footer-default p {
    color: #fff;
  }

  .am-footer-default a {
    color: #fff;
  }

  video {
    width: 100%;
    height: auto;
  }
</style>
<link rel="stylesheet" href="{{ static_path('css/duoshuo.css') }}">
{% end %}

{% block nav %}{% end %}

{% block body %}
<div class="am-g-fixed am-g-fixed am-g-collapse am-u-sm-centered">
  <div class="am-u-sm-12 am-margin-left" style="color: #fff">
    <a class="am-text-sm am-btn-link" style="color: #fff" href="//{{ MAIN_HOST }}/">&laquo; tomorrow<a/>
  </div>
</div>

<header>
  <div class="am-margin-lg am-text-center">
    <a href="//{{ JOLLA_HOST }}/"><img alt="{{ _("Jolla Unofficial Chinese Blog") }}" src="https://dn-jolla.qbox.me/blog_header.png"></a>
  </div>
</header>

<div class="am-u-sm-centered am-g-fixed">
  {% if await %}
  <div class="am-alert" data-am-alert>
    <button type="button" class="am-close">&times;</button>
    <p>{{ _("Thanks for translation, we are checking if it's appropriate") }}</p>
  </div>
  {% end %}
  {% if reject %}
  <div class="am-alert am-alert-warning" data-am-alert>
    <button type="button" class="am-close">&times;</button>
    <p>{{ _("This article is not taken as the final translate. Sorry.") }}</p>
  </div>
  {% end %}

  <div class="am-g" id="bread-crumbs">
    <div class="am-u-sm-6" style="text-align: left">
      <span class="am-icon-arrow-circle-left"> <a class="am-text-sm" href="/">{{ _('Back to home') }}<a/></span> &nbsp;
    </div>
    <div class="am-u-sm-6 am-cf">

      <div class="am-dropdown am-fr" data-am-dropdown  data-role="switch-lang-dropper">
        <button class="am-btn am-btn-link am-dropdown-toggle am-btn-sm" style="color: #fff"><span class="am-icon-globe"></span> <span class="am-icon-caret-down"></span></button>
        <ul class="am-dropdown-content">
          <li class="am-dropdown-header">修改语言/Change Language</li>
          <li class="{{ 'am-active' if locale.code[:2] == 'zh' else '' }}">
            <a href="./?lang=zh" data-role="switch-lang" data-lang="zh" style="color: #000"><span class="am-badge am-badge-success">zh-CN</span> 中文/Chinese</a>
          </li>
          <li class="{{ 'am-active' if locale.code[:2] == 'en' else '' }}">
            <a href="./?lang=en" data-role="switch-lang" data-lang="en" style="color: #000"><span class="am-badge am-badge-success">en-US</span> 英文/English</a>
          </li>
        </ul>
      </div>

    </div>
  </div>


  {% if headimg %}
    <img src="{{ headimg }}" id="title-img">
  {% end %}
  <div class="am-g am-margin-bottom-xl" id="white-bg-box">
    <div class="am-u-sm-12 am-u-sm-centered" id="page-box">
      <article class="am-article">
        <div class="am-article-hd">
          <h1 class="am-article-title">{{ article['translated']['title'] }}</h1>
          <p class="am-article-meta">
            {% raw _('Posted by %(name)s%(email)s on %(time)s') % {
              'name': article['translated']['author'],
              'email': article['translated'].get('emaillink', ''),
              'time': createtime} %}
          </p>
        </div>

        <hr class="am-article-divider">
        <div class="am-article-bd">
          {% raw article['translated']['content'] %}
          <!-- Jolla blog author translation -->
          {% module Author(article['original']['author']) %}
        </div>

        <hr class="am-article-divider">
        <footer>
          <div id="license">
            <p>原文由 {{ article['original']['author'] }} 发布于 <a href="{{ article['original']['link'] }}">{{ article['original']['title'] }}</a>
            <p>{% module License(license, article['translated']['author'], article['translated'].get('emaillink', None)) %}</p>
          </div>
          {% if article['share'] %}
          <div>
            <p>本文已转载至:</p>
            <ul>
            {% for each in article['share'] %}
              <li><a href="{{ each['url'] }}" target="_blank">{{ each['name'] }}<span class="am-icon-external-link"></span></a></li>
            {% end %}
            </ul>
          </div>
          {% end %}
        </footer>
      </article>

      <div data-am-widget="duoshuo" class="am-duoshuo am-duoshuo-default" data-ds-short-name="tmr">
        <div class="ds-thread"
             data-thread-key="{{ article['id'] }}"
             data-title="{{ article['translated']['title'] }}"
             {% if headimg %}data-image="{{ headimg }}"{% end %}
             data-form-position="top"></div>
      </div>

    </div>
  </div>
</div>

<script type="text/javascript">
  var duoshuoQuery = {short_name:"tmr"};
  (function()
  {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]
    ).appendChild(ds);
  })();
</script>
{% end %}
